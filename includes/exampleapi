<h1 id='example-processing-outside-vba'>Example - Processing outside VBA</h1>
<blockquote>
<p>The following Visual Basic Script opens Microsoft Office Excel, logs on to IBM Cognos Analytics, refreshes the content, and logs off.</p>
</blockquote>
<pre class="highlight vb tab-vb"><code><span class="c1">' Start Excel in batch mode</span>
<span class="k">Set</span> <span class="n">objExcel</span> <span class="o">=</span> <span class="n">CreateObject</span><span class="p">(</span><span class="s">"Excel.Application"</span><span class="p">)</span>
<span class="n">objExcel</span><span class="p">.</span><span class="n">Visible</span> <span class="o">=</span> <span class="k">False</span>
<span class="n">objExcel</span><span class="p">.</span><span class="n">ScreenUpdating</span> <span class="o">=</span> <span class="k">False</span>
<span class="n">objExcel</span><span class="p">.</span><span class="n">DisplayAlerts</span> <span class="o">=</span> <span class="k">False</span>
<span class="c1">'Open a workbook that has IBM Cognos data</span>
<span class="n">in</span> <span class="n">it</span><span class="p">.</span>
<span class="n">Set</span> <span class="n">objWorkbook</span> <span class="o">=</span> <span class="n">objExcel</span><span class="p">.</span><span class="n">Workbooks</span><span class="p">.</span><span class="n">Open</span><span class="p">(</span><span class="s">"C:\workbook1.xls"</span><span class="p">)</span>
<span class="c1">' Call the wrapper macros</span>
<span class="n">bResult</span> <span class="o">=</span> <span class="n">CognosOfficeAutomationObject</span><span class="p">.</span><span class="n">Logon</span>
<span class="p">(</span><span class="s">"http://localhost/ibmcognos/cgi-bin/cognos.cgi"</span><span class="p">,</span>
<span class="s">"Administrator"</span><span class="p">,</span> <span class="s">"CognosAdmin"</span><span class="p">,</span> <span class="s">"Production"</span><span class="p">)</span>
<span class="n">objExcel</span><span class="p">.</span><span class="n">Run</span> <span class="s">"RefreshAllData"</span>
<span class="n">objExcel</span><span class="p">.</span><span class="n">Run</span> <span class="s">"Logoff"</span>
<span class="n">objExcel</span><span class="p">.</span><span class="n">Run</span> <span class="s">"TraceLog"</span><span class="p">,</span> <span class="s">"C:\AutomationLog.log"</span>
<span class="n">objWorkbook</span><span class="p">.</span><span class="n">Save</span>
<span class="n">objWorkbook</span><span class="p">.</span><span class="n">Close</span>
<span class="n">objExcel</span><span class="p">.</span><span class="n">Quit</span>
</code></pre>
<p>If you want to use IBM® Cognos® Office Automation outside VBA, you cannot call the APIs directly. This topic describes how you can call the APIs outside of VBA.</p>

<p>To use IBM Cognos Office Automation outside VBA, you must create wrapper macros in the Microsoft Office document for each API. You can then call these macros from your code. The module CognosOfficeAutomationExample.bas is an example of a wrapper macro that you can call from outside VBA.</p>
